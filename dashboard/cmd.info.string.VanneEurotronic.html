<div class="cmd #history# container-fluid tooltips cmd-widget widget-VanneEurotronic" data-type="info"
	data-version="#version#" data-eqLogic_id="#eqLogic_id#" data-subtype="other" data-template="VanneEurotronic"
	data-cmd_id="#id#" data-cmd_uid="#uid#">
	<img class="zoneimg#uid#" src="data/customTemplates/dashboard/cmd.info.string.VanneEurotronic/eurotronic3.png">
	<div class="zonetitre#uid#">#name_display#</div>
	<div class="zonetemp#uid#"></div>
	<div class="zonemode#uid#"></div>
	<div class="zonebatterie#uid#"></div>
	<div class="zoneetat#uid#">
		<div class="circle#uid#"></div>
	</div>
	<div class="timeCmd label label-default #history#" data-type="info"></div>
	<template>
		<div>name_display : nom par défaut ({{Nom à afficher}})</div>
		<div>time : duration|date ({{Affiche durée ou date de la valeur}})</div>
	</template>
	<script>
		jeedom.cmd.addUpdateFunction('#id#', function (_options) {
			if (is_object(cmd = document.querySelector('.cmd[data-cmd_uid="#uid#"]'))) {
				cmd.setAttribute('title', '{{Date de valeur}}: ' + _options.valueDate + '<br>{{Date de collecte}}: ' + _options.collectDate);
				if ('#time#' == 'duration' || '#time#' == 'date') {
					jeedom.cmd.displayDuration(_options.valueDate, cmd.querySelector('.timeCmd'), '#time#');
				}

				// Récupération des valeurs des paramètres
				// var name = ('#name#' != '#' + 'name#') ? "#name#" : "NA";
				// if (name == "NA") {
				// 	$('.zonetitre#uid#').hide();
				// } else {
				// 	$('.zonetitre#uid#').text(name);
				// }

				// Récupération des valeurs
				var state = _options.display_value;
				var stateListe = state.split(";");
				var temp = stateListe[0];
				var mode = stateListe[1];
				var tempeco = stateListe[2];
				var tempchauffage = stateListe[3];
				var batterie = stateListe[4];

				// Conversion code en nom pour le mode
				if (mode == "0") mode = "Eteint";
				if (mode == "31") mode = "Manuel";
				if (mode == "1") mode = "Chauffage";
				if (mode == "15") mode = "Pleine chauffe";
				if (mode == "11") mode = "Eco";


				if (mode == "Eteint") {
					cmd.querySelector('.circle#uid#').style.background = 'white';
				} else if (mode == "Chauffage") {
					cmd.querySelector('.circle#uid#').style.background = 'green';
				} else if (mode == "Pleine chauffe") {
					cmd.querySelector('.circle#uid#').style.background = 'red';
				} else {
					cmd.querySelector('.circle#uid#').style.background = 'orange';
				}

				var tempaffiche = parseFloat(temp).toFixed(1);
				cmd.querySelector('.zonetemp#uid#').innerHTML = tempaffiche;
				if (mode == "Eco") {
					// $('.zonemode#uid#').text("ECO " + tempeco + "°C");
					cmd.querySelector('.zonemode#uid#').innerHTML = "ECO " + tempeco + "°C";
				}
				else if (mode == "Pleine chauffe") {
					// $('.zonemode#uid#').text("MAXIMUM");
					cmd.querySelector('.zonemode#uid#').innerHTML = "MAXIMUM";
				}
				else if (mode == "Chauffage") {
					// $('.zonemode#uid#').text("CHF " + tempchauffage + "°C");
					cmd.querySelector('.zonemode#uid#').innerHTML = "CHF " + tempchauffage + "°C";
				}
				else {
					// $('.zonemode#uid#').text(mode);
					cmd.querySelector('.zonemode#uid#').innerHTML = mode;
				}
				// $('.zonebatterie#uid#').text(batterie + "%");
				cmd.querySelector('.zonebatterie#uid#').innerHTML = batterie + "%";
			}
		});
		jeedom.cmd.refreshValue([{ cmd_id: '#id#', value: '#value#', display_value: '#state#', valueDate: '#valueDate#', collectDate: '#collectDate#', alertLevel: '#alertLevel#', unit: '#unite#' }]);
	</script>
	<style>
		@font-face {
			font-family: "Digital-7";
			src: url("data/customTemplates/dashboard/cmd.info.string.VanneEurotronic/font/digital-7.ttf") format("truetype");
		}

		.widget-VanneEurotronic img.zoneimg#uid# {
			height: 120px;
			width: 120px;
		}

		.widget-VanneEurotronic div.zonetitre#uid# {
			font-family: "Digital-7";
			position: relative;
			color: #2E2E2E;
			font-size: 12px;
			width: 90px;
			height: 12px;
			/* top: 20px; */
			/* left: 50%; */
			/* transform: translate(-50%, -50%); */
			/* text-align: center; */
			font-weight: bold !important;
			bottom: 104px;
			margin-bottom: -12px;
		}

		.widget-VanneEurotronic div.zonetemp#uid# {
			font-family: "Digital-7";
			position: relative;
			color: #2E2E2E;
			letter-spacing: 1px;
			font-size: 50px;
			/* top: 43px; */
			/* left: 40px; */
			width: 100px;
			/* text-align: left; */
			font-weight: bold !important;
			bottom: 78px;
			margin-bottom: -12px;
		}

		.widget-VanneEurotronic div.zonemode#uid# {
			font-family: "Digital-7";
			position: relative;
			color: #2E2E2E;
			letter-spacing: 1px;
			font-size: 16px;
			/* top: 80px; */
			/* left: 50%; */
			width: 100%;
			height: 16px;
			/* transform: translate(-50%, -50%); */
			/* text-align: center; */
			font-weight: bold !important;
			bottom: 45px;
			margin-bottom: -16px;
		}

		.widget-VanneEurotronic div.zonebatterie#uid# {
			font-family: "Digital-7";
			position: relative;
			color: black;
			letter-spacing: 1px;
			font-size: 14px;
			/* top: 95px; */
			left: 20px;
			width: 30px;
			bottom: 25px;
			margin-bottom: -12px;
		}

		.widget-VanneEurotronic div.zoneetat#uid# {
			position: relative;
			/* top: 98px; */
			/* left: 35px; */
			width: 10px;
			height: 10px;
			/* border-radius: 20px; */
			/* border: solid white 1px; */
			bottom: 24px;
			right: 37px;
			margin-bottom: -10px;
		}

		.widget-VanneEurotronic div.circle#uid# {
			position: absolute;
			width: 10px;
			height: 10px;
			border-radius: 20px;
		}
	</style>
</div>